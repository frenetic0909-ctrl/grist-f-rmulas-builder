<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
</head>

<body style="font-family:sans-serif;text-align:center">
  <button id="reloadBtn">ğŸ”„ Force Reload</button>
  <div id="status"></div>

<script>
grist.ready(() => {
  const btn = document.getElementById("reloadBtn");
  const status = document.getElementById("status");

  btn.onclick = async () => {
    btn.disabled = true;
    status.innerText = "â³ Solicitando reload...";

    try {
      const info = await grist.getDocPageInfo();

      await fetch("/_admin/force-reload", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ doc_id: info.docId })
      });

      status.innerText = "âœ… Solicitud enviada";
    } catch {
      status.innerText = "âŒ Error";
    } finally {
      btn.disabled = false;
    }
  };
});
</script>
</body>
</html>
